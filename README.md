# Документация к проекту Vosk MP3 to JSON

## Описание

Данный проект представляет собой веб-приложение, использующее библиотеку Vosk для распознавания речи. Приложение принимает аудиофайл формата MP3, конвертирует его в WAV и распознает текст, возвращая его в формате JSON. 

## Установка

### Требования

Перед началом установки убедитесь, что у вас установлены следующие компоненты:
- Python версии 3.6 или выше
- pip (менеджер пакетов для Python)
- Docker (для использования Docker-версии)

### Установка на Linux и MacOS

1. **Скачивание модели**: 
   Откройте терминал и выполните следующую команду для скачивания модели Vosk:

   ```bash
   curl -o ./model.zip https://alphacephei.com/vosk/models/vosk-model-small-ru-0.22.zip
   ```

2. **Распаковка модели**:
   Распакуйте загруженный файл в текущую папку:

   ```bash
   unzip model.zip -d model
   ```

3. **Установка зависимостей**:
   Убедитесь, что у вас есть файл `requirements.txt` в корневой директории проекта. Установите необходимые библиотеки:

   ```bash
   pip install -r requirements.txt
   ```

4. **Запуск приложения**:
   Запустите Flask-приложение:

   ```bash
   python app.py
   ```

### Установка на Windows

1. **Скачивание модели**:
   Откройте командную строку и выполните следующую команду для скачивания модели Vosk:

   ```cmd
   curl -o model.zip https://alphacephei.com/vosk/models/vosk-model-small-ru-0.22.zip
   ```

   Если `curl` не установлен, вы можете скачать модель через браузер и сохранить файл в корневую директорию проекта.

2. **Распаковка модели**:
   Распакуйте загруженный файл в текущую папку. Вы можете использовать встроенные средства Windows для распаковки ZIP-файлов.

3. **Установка зависимостей**:
   Убедитесь, что у вас есть файл `requirements.txt` в корневой директории проекта. Установите необходимые библиотеки:

   ```cmd
   pip install -r requirements.txt
   ```

4. **Запуск приложения**:
   Запустите Flask-приложение:

   ```cmd
   python app.py
   ```

### Установка с использованием Docker

1. **Клонирование репозитория** (если необходимо):
   Сначала клонируйте репозиторий, если вы еще этого не сделали.

   ```bash
   git clone  https://github.com/pai9maker/vosk_mp3_to_json.git
   cd <имя_папки_репозитория>
   ```

2. **Запуск Docker**:
   В корневой директории проекта выполните команду:

   ```bash
   docker-compose up --build
   ```

## Использование

После запуска приложения оно будет доступно по адресу `http://localhost:5000/asr`. Вы можете отправить POST-запрос с аудиофайлом в формате MP3.

### Пример запроса с использованием curl

```bash
curl -X POST -F 'file=@/path/to/your/audio.mp3' http://localhost:5000/asr
```

### Пример ответа

Ответ будет в формате JSON и будет содержать распознанный текст:

```json
{
    "dialog": [
        {
            "source": "receiver",
            "text": "Привет, как дела?",
            "duration": 5,
            "raised_voice": false,
            "gender": "male"
        },
        {
            "source": "transmitter",
            "text": "Все хорошо, спасибо!",
            "duration": 5,
            "raised_voice": false,
            "gender": "female"
        }
    ],
    "result_duration": {
        "receiver": 5,
        "transmitter": 5
    }
}
```

## Удаление временных файлов

Приложение автоматически удаляет временные WAV-файлы после обработки.

## Заключение

Теперь у вас есть полное руководство по установке и использованию приложения Vosk MP3 to JSON на различных операционных системах. Если у вас возникли проблемы, пожалуйста, проверьте логи приложения и убедитесь, что все зависимости установлены корректно.
